import{classNames,select}from"../settings.js";class Form{constructor(e){this.dom=e,this.validity=!1,this.getElements(),this.initActions()}getElements(){this.allInputs=this.dom.querySelectorAll(select.form.input)}initActions(){this.dom.addEventListener("change",e=>{e.preventDefault(),this.validate(e.target)}),this.dom.addEventListener("submit",e=>{e.preventDefault(),this.validateForm(),this.validity&&console.log("submit form")})}validate(e){let t=!0,s="";return e.required&&!e.value&&(t=!1,s="This field is required"),e.value&&"email"===e.type&&-1===e.value.search(/.{1,}@.{1,}/g)&&(t=!1,s="Incorrect email"),"password"===e.type&&"repeat"===e.name&&e.value&&this.dom.querySelector(select.form.typePassword).value!=e.value&&(t=!1,s="Incorrect password"),e.classList.toggle(classNames.form.invalidInput,!t),this.updateMessage(e,s),t}validateForm(){this.validity=!0;for(let e of this.allInputs){this.validate(e)||(this.validity=!1)}}updateMessage(e,t){let s=e.parentElement.querySelector(select.form.validityMessage);!s&&t?(s=document.createElement("div"),s.classList.add(classNames.form.messageVisible),s.innerText=t,e.parentElement.append(s)):s&&(s.innerText=t,s.classList.toggle(classNames.form.messageVisible,t))}}export default Form;