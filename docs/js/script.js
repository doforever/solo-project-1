import Popup from"./popup.js";import{templates,select}from"../settings.js";import Contact from"./contact.js";class Chat extends Popup{constructor(t,e){super(),this.dataObject=this.prepareData(t,e),this.template=templates.popupChat}prepareData(t,e){return{title:t,type:e}}chooseContact(t){this.contact=new Contact(this.dataObject.type,t),this.dataObject.contactStatus=this.contact.status,this.dataObject.contactName=this.contact.nick,this.dataObject.contactAvatar=this.contact.avatar}open(t){this.chooseContact(t),super.open()}getElements(){this.dom.send=this.dom.element.querySelector(select.popup.buttonConfirm)}initActions(){super.initActions(),this.dom.send.addEventListener("click",t=>{t.preventDefault(),this.hideBackground(),this.close()})}}export default Chat;import Popup from"./popup.js";import{settings,templates,select}from"../settings.js";class Confirm extends Popup{constructor(t,e,s){super(),this.dataObject=this.prepareData(t,e,s),this.template=templates.popupConfirm}prepareData(t,e=settings.popup.confirmationDefault,s=settings.popup.cancellationDefault){return{question:t,confirmation:e,cancellation:s}}getElements(){this.dom.confirm=this.dom.element.querySelector(select.popup.buttonConfirm)}initActions(){super.initActions(),this.dom.confirm.addEventListener("click",()=>{this.hideBackground(),this.close()})}}export default Confirm;import dataSource from"../data.js";class Contact{constructor(t,e){this.nick=dataSource[t][e].nick,this.avatar=dataSource[t][e].avatar,this.status=dataSource[t][e].status}}export default Contact;import{classNames,select}from"../settings.js";class Form{constructor(t){this.dom=t,this.validity=!1,this.getElements(),this.initActions()}getElements(){this.allInputs=this.dom.querySelectorAll(select.form.input)}initActions(){this.dom.addEventListener("change",t=>{t.preventDefault(),this.validate(t.target)}),this.dom.addEventListener("submit",t=>{t.preventDefault(),this.validateForm(),this.validity&&console.log("submit form")})}validate(t){let e=!0,s="";return t.required&&!t.value&&(e=!1,s="This field is required"),t.value&&"email"===t.type&&-1===t.value.search(/.{1,}@.{1,}/g)&&(e=!1,s="Incorrect email"),"password"===t.type&&"repeat"===t.name&&t.value&&this.dom.querySelector(select.form.typePassword).value!=t.value&&(e=!1,s="Incorrect password"),t.classList.toggle(classNames.form.invalidInput,!e),this.updateMessage(t,s),e}validateForm(){this.validity=!0;for(let t of this.allInputs){this.validate(t)||(this.validity=!1)}}updateMessage(t,e){let s=t.parentElement.querySelector(select.form.validityMessage);!s&&e?((s=document.createElement("div")).classList.add(classNames.form.messageVisible),s.innerText=e,t.parentElement.append(s)):s&&(s.innerText=e,s.classList.toggle(classNames.form.messageVisible,e))}}export default Form;import{select,classNames}from"../settings.js";class Popup{constructor(){this.getBackground(),this.initGlobalActions(),this.dataObject=null,this.template=null}getBackground(){this.dom={},this.dom.background=document.querySelector(select.popup.background)}render(){let t=document.createElement("div");this.template&&(t.innerHTML=this.template(this.dataObject).trim()),this.dom.element=t.firstChild,this.dom.element&&this.dom.background.appendChild(this.dom.element)}getElements(){}initGlobalActions(){document.addEventListener("keyup",t=>{"Escape"===t.key&&this.dom.element&&this.close()}),this.dom.background.addEventListener("click",()=>{this.dom.element&&this.close()})}initActions(){this.dom.element.addEventListener("click",t=>{t.stopPropagation(),t.target.classList.contains(classNames.popup.buttonClose)&&(this.hideBackground(),this.close())})}show(){this.dom.element.classList.add(classNames.popup.visible)}open(){this.render(),this.getElements(),this.initActions(),this.show()}close(){this.dom.element.remove()}hideBackground(){this.dom.background.classList.remove(classNames.popup.backgroundVisible)}}export default Popup;import{select,settings,classNames}from"../settings.js";import dataSource from"../data.js";class StatChart{constructor(){this.getData(),this.initPlugin(),this.renderLegend(),this.initActions()}getData(){const t=settings.chart.colors;let e=0;const s=[],a=[];for(let i in dataSource.stats){const o=dataSource.stats[i],n={label:o.label,backgroundColor:t[e],borderColor:t[e],data:[]};for(let t in o.data){let e=o.data[t];n.data.push(e);const s=this.prepareLabel(t);a.includes(s)||a.push(s)}e++,s.push(n)}this.data={labels:a,datasets:s}}prepareLabel(t){let e=t.toString();return t<10&&(e="0"+e),e}initPlugin(){const t=document.querySelector(select.chart.context).getContext("2d");this.myBar=new Chart(t,{type:"bar",data:this.data,options:{responsive:!0,legendCallback:function(t){let e=[];e.push("<ul>");for(let s=0;s<t.data.datasets.length;s++)e.push('<li data-index="'+s+'">'),e.push('<span style="background-color:'+t.data.datasets[s].backgroundColor+'"></span>'+t.data.datasets[s].label),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{display:!1},title:{display:!1}}})}renderLegend(){const t=this.myBar.generateLegend();this.dom={},this.dom.legendWrapper=document.querySelector(select.chart.legendWrapper),this.dom.legendWrapper.innerHTML=t,this.dom.legendButtons=this.dom.legendWrapper.querySelectorAll(select.chart.legendButtons);for(let t of settings.chart.hiddenDefault)this.filterData(this.dom.legendButtons[t])}initActions(){this.dom.legendWrapper.addEventListener("click",t=>{"LI"===t.target.tagName&&this.filterData(t.target)})}filterData(t){let e=t.dataset.index,s=this.myBar.getDatasetMeta(e);s.hidden=null===s.hidden?!this.myBar.data.datasets[e].hidden:null,this.myBar.update(),t.classList.toggle(classNames.chart.datasetHidden,s.hidden)}}export default StatChart;