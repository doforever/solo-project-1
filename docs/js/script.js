import{classNames,select,settings}from"./settings.js";import Form from"./components/form.js";import Confirm from"./components/confirm.js";import Chat from"./components/chat.js";import StatChart from"./components/statChart.js";import DateRange from"./components/dateRange.js";const app={init:function(){this.getElements(),this.initPopups(),this.initForm(),this.initPlugins(),this.initPages(),this.initActions(),console.log("thisApp",this)},getElements:function(){this.dom={},this.dom.menuToggle=document.querySelector(select.header.menuToggleBtn),this.dom.sidebar=document.querySelector(select.sidebar.sidebar),this.pages=document.querySelectorAll(select.main.pages),this.navLinks=document.querySelectorAll(select.sidebar.navLinks),this.dom.quit=document.querySelector(select.topBar.quit),this.dom.manager=document.querySelector(select.sidebar.managerLink),this.dom.popupBackground=document.querySelector(select.popup.background),this.dom.dateRange=document.querySelector(select.statistics.dateRange)},initPlugins:function(){this.chart=new StatChart,this.dateRange=new DateRange(this.dom.dateRange)},initActions:function(){this.dom.menuToggle.addEventListener("click",()=>{this.dom.sidebar.classList.toggle(classNames.sidebar.sidebarExpaded)}),this.dom.quit.addEventListener("click",()=>{this.showPopupBackground(),this.popupConfirm.open()}),this.dom.manager.addEventListener("click",()=>{this.showPopupBackground(),this.popupChat.open(this.dom.manager.dataset.id)}),document.addEventListener("keyup",t=>{"Escape"===t.key&&this.hidePopupBackground()}),this.dom.popupBackground.addEventListener("click",()=>{this.hidePopupBackground()})},initPages:function(){const t=this,e=window.location.hash.replace("#/","");let i=this.navLinks[0].getAttribute("href").replace("#","");for(let t of this.navLinks){const s=t.getAttribute("href").replace("#","");if(s==e){i=s;break}}t.activatePage(i);for(let e of this.navLinks)e.addEventListener("click",(function(e){e.preventDefault();const i=this.getAttribute("href").replace("#","");t.activatePage(i),window.location.hash="#/"+i}))},activatePage:function(t){const e=settings.pagesMap[t]||[];for(let t of this.pages)t.classList.toggle(classNames.pages.active,e.includes(t.id));for(let e of this.navLinks)e.classList.toggle(classNames.sidebar.navLinkActive,e.getAttribute("href")=="#"+t)},initForm:function(){const t=document.querySelector(select.form.wrapper);this.form=new Form(t)},initPopups:function(){this.popupConfirm=new Confirm(settings.popup.questionQuit,settings.popup.confirmationQuit),this.popupChat=new Chat(settings.popup.managerChatTitle,settings.popup.typeManagerChat)},showPopupBackground:function(){this.dom.popupBackground.classList.add(classNames.popup.backgroundVisible)},hidePopupBackground:function(){this.dom.popupBackground.classList.remove(classNames.popup.backgroundVisible)}};app.init();